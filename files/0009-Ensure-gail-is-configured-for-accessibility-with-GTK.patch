From 7c012aa902ab05d0eea6bc41547c4dfe7a4d9e3d Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Sun, 16 Oct 2016 10:44:23 +0100
Subject: [PATCH 9/9] Ensure gail is configured for accessibility with
 GTK_MODULES

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 Makefile.am                    |  1 +
 configure.ac                   |  1 +
 env/50-budgie-accessibility.sh |  7 +++++++
 env/Makefile.am                | 11 +++++++++++
 4 files changed, 20 insertions(+)
 create mode 100644 env/50-budgie-accessibility.sh
 create mode 100644 env/Makefile.am

diff --git a/Makefile.am b/Makefile.am
index 1b368ab..a2db6e4 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -1,4 +1,5 @@
 SUBDIRS = \
+	env \
 	icon \
 	lightdm \
 	schemas
diff --git a/configure.ac b/configure.ac
index 3dff21f..ebfba38 100644
--- a/configure.ac
+++ b/configure.ac
@@ -3,6 +3,7 @@ AM_INIT_AUTOMAKE([-Wno-portability no-dist-gzip dist-xz foreign subdir-objects])
 AC_PREFIX_DEFAULT(/usr/local)
 
 AC_CONFIG_FILES([Makefile
+                env/Makefile
                 icon/Makefile
                 lightdm/Makefile
                 schemas/Makefile
diff --git a/env/50-budgie-accessibility.sh b/env/50-budgie-accessibility.sh
new file mode 100644
index 0000000..cc16460
--- /dev/null
+++ b/env/50-budgie-accessibility.sh
@@ -0,0 +1,7 @@
+# Begin /usr/share/defaults/etc/profile.d/50-budgie-accessibility.sh
+
+if [ -z "${GTK_MODULES}" ]; then
+    export GTK_MODULES="gail:atk-bridge"
+fi
+
+# End /usr/share/defaults/etc/profile.d/50-budgie-accessibility.sh
diff --git a/env/Makefile.am b/env/Makefile.am
new file mode 100644
index 0000000..6390c1e
--- /dev/null
+++ b/env/Makefile.am
@@ -0,0 +1,11 @@
+ENV_FILES = \
+	50-budgie-accessibility.sh
+
+EXTRA_DIST = \
+	$(ENV_FILES)
+
+envdir = \
+	$(datadir)/defaults/etc/profile.d
+
+env_DATA = \
+	$(ENV_FILES)
-- 
2.10.1

